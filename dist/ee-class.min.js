!function(e,t){"use strict";"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&"object"==typeof module.exports?module.exports=t():("object"!=typeof e.ee&&(e.ee={}),e.ee.Class=t())}(this,function(){"use strict";var e,t,r;return e=function(e,r,n,o){r["super"]=function(){var t,n,o;if(r.___super){for(t=[],n=0,o=arguments.length;o>n;n++)t.push(arguments[n]);return r.___super.apply(this,t)}throw new Error("The method «"+e+"» has no super «"+e+"» method on any protoype!")},r.local||Object.defineProperty(r,"local",{value:o}),n&&n.prototype&&t(e,r,n.prototype,o)},t=function(e,r,n,o){r.local||Object.defineProperty(r,"local",{value:o}),n&&(Object.hasOwnProperty.call(n,e)?Object.defineProperty(r,"___super",{value:n[e]}):n.___isEeClass||"init"!==e||"object"!=typeof n||"function"!=typeof n.constructor?t(e,r,"object"==typeof n?Object.getPrototypeOf(n):null,o):Object.defineProperty(r,"___super",{value:n.constructor}))},r=function(t){var n,o={};return this instanceof r?(t.inherits&&t.inherits.___properties&&(o=t.inherits.___properties),Object.keys(t).forEach(function(r){var n=t[r];"inherits"!==r&&("function"==typeof n?(o[r]={value:n,enumerable:"_"!==r[0]},o[r].value.displayName||Object.defineProperty(o[r].value,"displayName",{value:r}),e(r,n,t.inherits,t)):"object"==typeof n&&"[object Object]"===Object.prototype.toString.call(n)?Object.hasOwnProperty.call(n,"get")||Object.hasOwnProperty.call(n,"value")||Object.hasOwnProperty.call(n,"set")?Object.keys(n).some(function(e){return-1===["get","set","value","enumerable","writable","configurable"].indexOf(e)})?o[r]=o[r]={value:n,enumerable:!0,writable:!0}:(o[r]=n,"function"==typeof n.value&&(e(r,n.value,t.inherits,t),n.value.displayName||Object.defineProperty(n.value,"displayName",{value:r}))):o[r]=o[r]={value:n,enumerable:!0,writable:!0}:o[r]={value:n,enumerable:!0,writable:!0})}),"function"==typeof Symbol&&Symbol.iterator in t&&(o[Symbol.iterator]={value:t[Symbol.iterator],writable:!0}),n=function(){var e,r,o,i=[];if(!(this instanceof n))throw new Error("the class constructor was called without the «new» keyword!");for(r=0,o=arguments.length;o>r;r++)i.push(arguments[r]);return this.init?e=this.init.apply(this,i):"function"==typeof t.inherits&&t.inherits.apply(this,i),"undefined"!=typeof e?e:void 0},n.prototype=Object.create(t.inherits?t.inherits.prototype?t.inherits.prototype:t.inherits:{},o),Object.defineProperty(n.prototype,"___isEeClass",{value:!0}),n):Object.create(r,{value:{value:t,enumerable:!0}})},r.Enumerable=function(){return Object.defineProperty(this,"enumerable",{value:!0,enumerable:!0}),this},r.Configurable=function(){return Object.defineProperty(this,"configurable",{value:!0,enumerable:!0}),this},r.Writable=function(){return Object.defineProperty(this,"writable",{value:!0,enumerable:!0}),this},r.proto=function(e){return"object"==typeof e?Object.getPrototypeOf(e):void 0},r.keys=function(e){var t=[];for(var r in e)t.push(r);return t},r.define=function(e,t,r){Object.defineProperty(e,t,r)},r.implement=function(e,t){return r.keys(e).forEach(function(r){t[r]=e[r]}),t},r.inspect=function(e,t){return t=t||{},Object.getOwnPropertyNames(e).sort().forEach(function(r){"function"==typeof e[r]?t[r]=function(){}:"___isEeClass"!==r&&(t[r]=e[r])}),Object.getPrototypeOf(e)&&(t["super"]={},r.inspect(Object.getPrototypeOf(e),t["super"])),t},r});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsYXNzLmpzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZGVmaW5lIiwiYW1kIiwibW9kdWxlIiwiZXhwb3J0cyIsImVlIiwiQ2xhc3MiLCJ0aGlzIiwic2V0U3VwZXIiLCJzZXRTdXBlclByb3RvdHlwZSIsIm5hbWUiLCJiYXNlIiwicHJvdG8iLCJwYXJlbnQiLCJhcmdzIiwiaSIsImwiLCJfX19zdXBlciIsImFyZ3VtZW50cyIsImxlbmd0aCIsInB1c2giLCJhcHBseSIsIkVycm9yIiwibG9jYWwiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiX19faXNFZUNsYXNzIiwiY29uc3RydWN0b3IiLCJnZXRQcm90b3R5cGVPZiIsImNsYXNzRGVmaW5pdGlvbiIsImNsYXNzQ29uc3RydWN0b3IiLCJwcm9wZXJ0aWVzIiwiaW5oZXJpdHMiLCJfX19wcm9wZXJ0aWVzIiwia2V5cyIsImZvckVhY2giLCJrZXkiLCJwcm9wZXJ0eSIsImVudW1lcmFibGUiLCJkaXNwbGF5TmFtZSIsInRvU3RyaW5nIiwic29tZSIsImluZGV4T2YiLCJ3cml0YWJsZSIsIlN5bWJvbCIsIml0ZXJhdG9yIiwicmVzdWx0IiwiaW5pdCIsImNyZWF0ZSIsIkVudW1lcmFibGUiLCJDb25maWd1cmFibGUiLCJXcml0YWJsZSIsImluc3RhbmNlIiwidW5kZWZpbmVkIiwiZGVzY3JpcHRvciIsImltcGxlbWVudCIsInNvdXJjZSIsInRhcmdldCIsImluc3BlY3QiLCJvYmoiLCJkZXNjcmlwdGlvbiIsImdldE93blByb3BlcnR5TmFtZXMiLCJzb3J0Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFVQSxFQUFNQyxHQUNaLFlBRXNCLG1CQUFYQyxTQUF5QkEsT0FBT0MsSUFHdkNELFVBQVdELEdBQ2MsZ0JBQVhHLFNBQWlELGdCQUFuQkEsUUFBT0MsUUFHbkRELE9BQU9DLFFBQVVKLEtBS00sZ0JBQVpELEdBQUtN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cEMsT0FBT0YsSUFJWGhDLEVBQU1MLE9BQVMsU0FBU3VELEVBQVVmLEVBQVVpQixHQUN4Q2xDLE9BQU9DLGVBQWUrQixFQUFVZixFQUFVaUIsSUFJOUNwRCxFQUFNcUQsVUFBWSxTQUFTQyxFQUFRQyxHQUsvQixNQUpBdkQsR0FBTWdDLEtBQUtzQixHQUFRckIsUUFBUSxTQUFTQyxHQUNoQ3FCLEVBQU9yQixHQUFPb0IsRUFBT3BCLEtBR2xCcUIsR0FJWHZELEVBQU13RCxRQUFVLFNBQVNDLEVBQUtDLEdBaUIxQixNQWhCQUEsR0FBY0EsTUFFZHhDLE9BQU95QyxvQkFBb0JGLEdBQUtHLE9BQU8zQixRQUFRLFNBQVM3QixHQUMzQixrQkFBZHFELEdBQUlyRCxHQUNYc0QsRUFBWXRELEdBQVEsYUFFTixpQkFBVEEsSUFDTHNELEVBQVl0RCxHQUFRcUQsRUFBSXJELE1BSTVCYyxPQUFPUSxlQUFlK0IsS0FDdEJDLEVBQUFBLFlBQ0ExRCxFQUFNd0QsUUFBUXRDLE9BQU9RLGVBQWUrQixHQUFNQyxFQUFBQSxXQUd2Q0EsR0FJSjFEIiwiZmlsZSI6ImNsYXNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKHJvb3QsIGZhY3RvcnkpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIC8vIEFNRFxuICAgICAgICBcbiAgICAgICAgZGVmaW5lKFtdLCBmYWN0b3J5KTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgLy8gTm9kZVxuXG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEVFIE5hbWVzcGFjZVxuXG4gICAgICAgIC8vIGNyZWF0ZSBuYW1lc3BhY2UgYXMgbmVlZGVkXG4gICAgICAgIGlmICh0eXBlb2Ygcm9vdC5lZSAhPT0gJ29iamVjdCcpIHJvb3QuZWUgPSB7fTtcblxuICAgICAgICAvLyBwdWJsaXNoXG4gICAgICAgIHJvb3QuZWUuQ2xhc3MgPSBmYWN0b3J5KCk7XG4gICAgfVxufSkodGhpcywgZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG5cbiAgICB2YXIgICBzZXRTdXBlclxuICAgICAgICAsIHNldFN1cGVyUHJvdG90eXBlXG4gICAgICAgICwgQ2xhc3M7XG5cblxuICAgIC8vIHNldCB0aGUgc3VwZXIgbWV0aG9kIG9uIGVhY2ggbWV0aG9kIHdoaWNoIGlzIHVzZWQgdG8gY2FsbCB0aGUgbmV4dCBtZXRob2Qgb2YgdGhlIHNhbWUgbmFtZSBpbiB0aGUgcHJvdG90eXBlIGNoYWluXG4gICAgc2V0U3VwZXIgPSBmdW5jdGlvbihuYW1lLCBiYXNlLCBwcm90bywgcGFyZW50KSB7XG4gICAgICAgIGJhc2Uuc3VwZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhcmdzLCBpLCBsO1xuXG4gICAgICAgICAgICBpZiAoYmFzZS5fX19zdXBlcikge1xuICAgICAgICAgICAgICAgIGFyZ3MgPSBbXTtcblxuICAgICAgICAgICAgICAgIC8vIGNvbnZlcnQgYXJncyBpbnRvIGFuIGFycnkgaW4gb3JkZXJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwLCBsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7XG5cbiAgICAgICAgICAgICAgICAvLyBjYWxsIHN1cGVyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJhc2UuX19fc3VwZXIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHRocm93IG5ldyBFcnJvcignVGhlIG1ldGhvZCDCqycrbmFtZSsnwrsgaGFzIG5vIHN1cGVyIMKrJytuYW1lKyfCuyBtZXRob2Qgb24gYW55IHByb3RveXBlIScpO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgLy8gbWFrZXMgdGhlIGxvY2FsIGNsYXNzIGRlZmlubml0aW9uIGF2YWlsYWJsZSB0byB0aGUgcGFyZW50IHNjb3BlXG4gICAgICAgIGlmICghYmFzZS5sb2NhbCkgT2JqZWN0LmRlZmluZVByb3BlcnR5KGJhc2UsICdsb2NhbCcsIHt2YWx1ZTogcGFyZW50fSk7XG5cbiAgICAgICAgaWYgKHByb3RvICYmIHByb3RvLnByb3RvdHlwZSkgc2V0U3VwZXJQcm90b3R5cGUobmFtZSwgYmFzZSwgcHJvdG8ucHJvdG90eXBlLCBwYXJlbnQpO1xuICAgIH07XG5cblxuICAgIC8vIGZpbmQgdGhlIG5leHQgbWV0aG9kIHdpdGggdGhlIHNhbWUgbmFtZSBvbiB0aGUgcHJvdG95cGUgY2hhaW5cbiAgICBzZXRTdXBlclByb3RvdHlwZSA9IGZ1bmN0aW9uKG5hbWUsIGJhc2UsIHByb3RvLCBwYXJlbnQpIHtcblxuICAgICAgICAvLyBtYWtlcyB0aGUgbG9jYWwgY2xhc3MgZGVmaW5uaXRpb24gYXZhaWxhYmxlIHRvIHRoZSBwYXJlbnQgc2NvcGVcbiAgICAgICAgaWYgKCFiYXNlLmxvY2FsKSBPYmplY3QuZGVmaW5lUHJvcGVydHkoYmFzZSwgJ2xvY2FsJywge3ZhbHVlOiBwYXJlbnR9KTtcblxuXG4gICAgICAgIGlmIChwcm90bykge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHByb3RvLCBuYW1lKSl7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGJhc2UsICdfX19zdXBlcicsIHt2YWx1ZTogcHJvdG9bbmFtZV19KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFwcm90by5fX19pc0VlQ2xhc3MgJiYgbmFtZSA9PT0gJ2luaXQnICYmIHR5cGVvZiBwcm90byA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIHByb3RvLmNvbnN0cnVjdG9yID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgLy8gYSBwbGFpbiBqcyBvYmplY3QgLi4uIHNldCBpdCBhcyBzdXBlciB0byB0aGUgaW5pdCBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiYXNlLCAnX19fc3VwZXInLCB7dmFsdWU6IHByb3RvLmNvbnN0cnVjdG9yfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZXRTdXBlclByb3RvdHlwZShuYW1lLCBiYXNlLCB0eXBlb2YgcHJvdG8gPT09ICdvYmplY3QnID8gT2JqZWN0LmdldFByb3RvdHlwZU9mKHByb3RvKSA6IG51bGwsIHBhcmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG5cblxuICAgIENsYXNzID0gZnVuY3Rpb24oY2xhc3NEZWZpbml0aW9uKSB7XG4gICAgICAgIHZhciAgIHByb3BlcnRpZXMgPSB7fVxuICAgICAgICAgICAgLCBjbGFzc0NvbnN0cnVjdG9yO1xuXG4gICAgICAgIC8vIG5vdCBjcmVhdGluZyBhIGNsYXNzLCBjcmVhdGluZyBhIHByb3BlcnR5IGRlc2NyaXB0b3IgaW5zdGVkXG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBDbGFzcykpIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuY3JlYXRlKENsYXNzLCB7dmFsdWU6e3ZhbHVlOiBjbGFzc0RlZmluaXRpb24sIGVudW1lcmFibGU6IHRydWV9fSk7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8vIGdldCBwcm9wZXJ0aWVzIGZyb20gc3VwZXIgY2xhc3MgZGVmaW5pdGlvblxuICAgICAgICBpZiAoY2xhc3NEZWZpbml0aW9uLmluaGVyaXRzICYmIGNsYXNzRGVmaW5pdGlvbi5pbmhlcml0cy5fX19wcm9wZXJ0aWVzKSBwcm9wZXJ0aWVzID0gY2xhc3NEZWZpbml0aW9uLmluaGVyaXRzLl9fX3Byb3BlcnRpZXM7XG5cbiAgICAgICAgLy8gY29sbGVjdCBhbGwgcHJvcGVydGllc1xuICAgICAgICBPYmplY3Qua2V5cyhjbGFzc0RlZmluaXRpb24pLmZvckVhY2goZnVuY3Rpb24oa2V5KXtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0eSA9IGNsYXNzRGVmaW5pdGlvbltrZXldO1xuXG4gICAgICAgICAgICAvLyBpbmhlcml0cyBmcm9tIGFub3RoZXIgY2xhc3MgLyBwcm90b3R5cGVcbiAgICAgICAgICAgIGlmIChrZXkgPT09ICdpbmhlcml0cycpIHJldHVybjtcblxuICAgICAgICAgICAgLy8gbWFwIGFzIG1ldGhvZFxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHByb3BlcnR5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgcHJvcGVydGllc1trZXldID0ge3ZhbHVlOiBwcm9wZXJ0eSwgZW51bWVyYWJsZToga2V5WzBdICE9PSAnXyd9O1xuXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBtYXkgYmUgdXNlZCB0byBidWlsZCBtb3JlIG1lYW5pbmdmdWwgc3RhY2sgdHJhY2VzXG4gICAgICAgICAgICAgICAgaWYgKCFwcm9wZXJ0aWVzW2tleV0udmFsdWUuZGlzcGxheU5hbWUpICBPYmplY3QuZGVmaW5lUHJvcGVydHkocHJvcGVydGllc1trZXldLnZhbHVlLCAnZGlzcGxheU5hbWUnLCB7dmFsdWU6IGtleX0pO1xuXG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlcmUgaXMgYW4gc3VwZXIgbWV0aG9kIHRvIGNhbGwgb24gYW55IG9mIHRoZSBwcm90b3R5cGVzXG4gICAgICAgICAgICAgICAgc2V0U3VwZXIoa2V5LCBwcm9wZXJ0eSwgY2xhc3NEZWZpbml0aW9uLmluaGVyaXRzLCBjbGFzc0RlZmluaXRpb24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBtb3JlIGFuYWx5dGljcyByZXF1aXJlZFxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHByb3BlcnR5ID09PSAnb2JqZWN0JyAmJiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwocHJvcGVydHkpID09PSAnW29iamVjdCBPYmplY3RdJykge1xuXG4gICAgICAgICAgICAgICAgLy8gcHJvcGVydHkgZGVzY3JpcHRvclxuICAgICAgICAgICAgICAgIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChwcm9wZXJ0eSwgJ2dldCcpIHx8IE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHByb3BlcnR5LCAndmFsdWUnKSB8fCBPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChwcm9wZXJ0eSwgJ3NldCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghT2JqZWN0LmtleXMocHJvcGVydHkpLnNvbWUoZnVuY3Rpb24oa2V5KXsgcmV0dXJuIFsnZ2V0JywgJ3NldCcsICd2YWx1ZScsICdlbnVtZXJhYmxlJywgJ3dyaXRhYmxlJywgJ2NvbmZpZ3VyYWJsZSddLmluZGV4T2Yoa2V5KSA9PT0gLTE7fSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZXJlIGFyIGVubyBvdGhlciBrZXlzIG9uIHRoZSBvYmVqY3QsIHdlIHNob3VsZCBleHBlY3QgYSBkZWZpbml0aW9uIGhlcnJlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXNba2V5XSA9IHByb3BlcnR5O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHByb3BlcnR5LnZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0U3VwZXIoa2V5LCBwcm9wZXJ0eS52YWx1ZSwgY2xhc3NEZWZpbml0aW9uLmluaGVyaXRzLCBjbGFzc0RlZmluaXRpb24pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBtYXkgYmUgdXNlZCB0byBidWlsZCBtb3JlIG1lYW5pbmdmdWwgc3RhY2sgdHJhY2VzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcm9wZXJ0eS52YWx1ZS5kaXNwbGF5TmFtZSkgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3BlcnR5LnZhbHVlLCAnZGlzcGxheU5hbWUnLCB7dmFsdWU6IGtleX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllc1trZXldID0gcHJvcGVydGllc1trZXldID0ge3ZhbHVlOiBwcm9wZXJ0eSwgZW51bWVyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWV9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzW2tleV0gPSBwcm9wZXJ0aWVzW2tleV0gPSB7dmFsdWU6IHByb3BlcnR5LCBlbnVtZXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZX07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBtYXAgYXMgc2NhbGFyIHByb3BlcnR5XG4gICAgICAgICAgICBlbHNlIHByb3BlcnRpZXNba2V5XSA9IHt2YWx1ZTogcHJvcGVydHksIGVudW1lcmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlfTtcbiAgICAgICAgfSk7XG5cblxuICAgICAgICAvLyBjaGVjayBmb3IgZXM2IGZlYXR1cmVzXG4gICAgICAgIGlmICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIFN5bWJvbC5pdGVyYXRvciBpbiBjbGFzc0RlZmluaXRpb24pIHByb3BlcnRpZXNbU3ltYm9sLml0ZXJhdG9yXSA9IHt2YWx1ZTogY2xhc3NEZWZpbml0aW9uW1N5bWJvbC5pdGVyYXRvcl0sIHdyaXRhYmxlOiB0cnVlfTtcblxuXG5cblxuXG4gICAgICAgIC8vIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHRoYXQgaXMgcmV0dXJuZWRcbiAgICAgICAgLy8gdG8gdGhlIHVzZXJcbiAgICAgICAgY2xhc3NDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB2YXIgICBhcmdzID0gW11cbiAgICAgICAgICAgICAgICAsIHJlc3VsdCwgaSwgbDtcblxuXG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgbmV3IGtleXdvcmQgd2FzIGZvcmdvdHRlblxuICAgICAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIGNsYXNzQ29uc3RydWN0b3IpKSB0aHJvdyBuZXcgRXJyb3IoJ3RoZSBjbGFzcyBjb25zdHJ1Y3RvciB3YXMgY2FsbGVkIHdpdGhvdXQgdGhlIMKrbmV3wrsga2V5d29yZCEnKTtcblxuICAgICAgICAgICAgLy8gY29udmVydCBhcmdzIGludG8gYW4gYXJyeSBpbiBvcmRlclxuICAgICAgICAgICAgZm9yIChpID0gMCwgbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIGFyZ3MucHVzaChhcmd1bWVudHNbaV0pO1xuXG5cbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBjbGFzcyBnb3QgYSBjb25zdHJ1Y3RvciBtZXRob2RcbiAgICAgICAgICAgIGlmICh0aGlzLmluaXQpIHJlc3VsdCA9IHRoaXMuaW5pdC5hcHBseSh0aGlzLCBhcmdzKTtcblxuICAgICAgICAgICAgLy8gb3Igd2UgaW5oZXJpdGVkIGZyb20gYSBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGNsYXNzRGVmaW5pdGlvbi5pbmhlcml0cyA9PT0gJ2Z1bmN0aW9uJykgY2xhc3NEZWZpbml0aW9uLmluaGVyaXRzLmFwcGx5KHRoaXMsIGFyZ3MpO1xuXG5cbiAgICAgICAgICAgIC8vIHdlIHJldHVybiBhbnl0aGluZyB3ZSBnb3QgZnJvbSB0aGUgY29uc3RydWN0b3IgYXMgcmVzdWx0XG4gICAgICAgICAgICBpZiAodHlwZW9mIHJlc3VsdCAhPT0gJ3VuZGVmaW5lZCcpIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG5cblxuXG5cbiAgICAgICAgLy8gc2V0IGNvbnN0cnVjdG9yIHByb3RvdHlwZVxuICAgICAgICBjbGFzc0NvbnN0cnVjdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoY2xhc3NEZWZpbml0aW9uLmluaGVyaXRzID8gKGNsYXNzRGVmaW5pdGlvbi5pbmhlcml0cy5wcm90b3R5cGUgPyBjbGFzc0RlZmluaXRpb24uaW5oZXJpdHMucHJvdG90eXBlIDogY2xhc3NEZWZpbml0aW9uLmluaGVyaXRzKSA6IHt9LCBwcm9wZXJ0aWVzKTtcblxuICAgICAgICAvLyBpZGVudGlmeSBhcyBlZSBjbGFzcyB1c2luZyB0aGUgaW5pdCBmdW5jdGlvbiBhcyBpdHMgY29udHJ1Y3RvclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xhc3NDb25zdHJ1Y3Rvci5wcm90b3R5cGUsICdfX19pc0VlQ2xhc3MnLCB7dmFsdWU6dHJ1ZX0pO1xuXG4gICAgICAgIHJldHVybiBjbGFzc0NvbnN0cnVjdG9yO1xuICAgIH07XG5cblxuXG5cbiAgICAvLyBzZXQgZW51bWVyYWJsZSBwcm9wZXJ0eVxuICAgIENsYXNzLkVudW1lcmFibGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdlbnVtZXJhYmxlJywge3ZhbHVlOiB0cnVlLCBlbnVtZXJhYmxlOiB0cnVlfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvLyBzZXQgY29uZmlndXJhYmxlIHByb3BlcnR5XG4gICAgQ2xhc3MuQ29uZmlndXJhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnY29uZmlndXJhYmxlJywge3ZhbHVlOiB0cnVlLCBlbnVtZXJhYmxlOiB0cnVlfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvLyBzZXQgd3JpdGFibGUgcHJvcGVydHlcbiAgICBDbGFzcy5Xcml0YWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgJ3dyaXRhYmxlJywge3ZhbHVlOiB0cnVlLCBlbnVtZXJhYmxlOiB0cnVlfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvLyByZXR1cm4gdGhlIGNsYXNzIHByb3RvdHlwZVxuICAgIENsYXNzLnByb3RvID0gZnVuY3Rpb24oaW5zdGFuY2UpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBpbnN0YW5jZSA9PT0gJ29iamVjdCcgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YoaW5zdGFuY2UpIDogdW5kZWZpbmVkO1xuICAgIH07XG5cbiAgICAvLyByZXR1cm4gYWxsIGVudW1lcmFibGUga2V5IG9mIHRoZSBjbGFzcyBhbiBpdHMgcHJvdG90eXBlc1xuICAgIENsYXNzLmtleXMgPSBmdW5jdGlvbihpbnN0YW5jZSkge1xuICAgICAgICB2YXIga2V5cyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gaW5zdGFuY2UpIGtleXMucHVzaChrZXkpO1xuICAgICAgICByZXR1cm4ga2V5cztcbiAgICB9O1xuXG4gICAgLy8gZGVmaW5lIGEgcHJvZXBydHkgb24gYW4gb2JqZXRjXG4gICAgQ2xhc3MuZGVmaW5lID0gZnVuY3Rpb24oaW5zdGFuY2UsIHByb3BlcnR5LCBkZXNjcmlwdG9yKXtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGluc3RhbmNlLCBwcm9wZXJ0eSwgZGVzY3JpcHRvcik7XG4gICAgfTtcblxuICAgIC8vIGltcGxlbWVudCBhIGNsYXNzIG9uIGFuIG9iamVjdFxuICAgIENsYXNzLmltcGxlbWVudCA9IGZ1bmN0aW9uKHNvdXJjZSwgdGFyZ2V0KSB7XG4gICAgICAgIENsYXNzLmtleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSl7XG4gICAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH07XG5cbiAgICAvLyBsaXN0IGFsbCBtZXRob2RzIG9mIGEgY2xhc3NcbiAgICBDbGFzcy5pbnNwZWN0ID0gZnVuY3Rpb24ob2JqLCBkZXNjcmlwdGlvbikge1xuICAgICAgICBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uIHx8IHt9O1xuXG4gICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9iaikuc29ydCgpLmZvckVhY2goZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBvYmpbbmFtZV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbltuYW1lXSA9IGZ1bmN0aW9uKCl7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5hbWUgIT09ICdfX19pc0VlQ2xhc3MnKSB7XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb25bbmFtZV0gPSBvYmpbbmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSkge1xuICAgICAgICAgICAgZGVzY3JpcHRpb24uc3VwZXIgPSB7fTtcbiAgICAgICAgICAgIENsYXNzLmluc3BlY3QoT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaiksIGRlc2NyaXB0aW9uLnN1cGVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkZXNjcmlwdGlvbjtcbiAgICB9O1xuXG5cbiAgICByZXR1cm4gQ2xhc3M7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
